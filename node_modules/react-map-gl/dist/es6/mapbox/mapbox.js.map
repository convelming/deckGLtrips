{"version":3,"sources":["../../../src/mapbox/mapbox.js"],"names":["PropTypes","noop","propTypes","container","object","mapboxApiAccessToken","string","attributionControl","bool","preserveDrawingBuffer","onLoad","func","onError","reuseMaps","reuseMap","transformRequest","mapStyle","visible","width","number","height","viewState","longitude","latitude","zoom","bearing","pitch","altitude","mapOptions","defaultProps","getAccessToken","preventStyleDiffing","accessToken","window","location","match","search","process","env","MapboxAccessToken","REACT_APP_MAPBOX_ACCESS_TOKEN","checkPropTypes","props","component","debug","Mapbox","constructor","mapboxgl","Error","initialized","console","version","_checkStyleSheet","_initialize","finalize","_destroy","setProps","_update","resize","_map","getMap","_create","savedMap","map","oldContainer","getContainer","newContainer","classList","add","childNodes","length","appendChild","_container","setStyle","document","body","center","style","interactive","Map","Object","assign","once","on","remove","canvas","getCanvas","outline","_updateMapViewport","_updateMapSize","oldProps","newProps","sizeChanged","oldViewState","_getViewState","newViewState","viewportChanged","jumpTo","_getMapboxViewStateProps","transform","mapboxVersion","testElement","createElement","className","display","append","isCssLoaded","getComputedStyle","position","link","setAttribute","head","error"],"mappings":"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","sourcesContent":["// Copyright (c) 2015 Uber Technologies, Inc.\n\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\n\n/* global window, document, process */\nimport PropTypes from 'prop-types';\n\nfunction noop() {}\n\nconst propTypes = {\n  // Creation parameters\n  container: PropTypes.object, /** The container to have the map. */\n  mapboxApiAccessToken: PropTypes.string, /** Mapbox API access token for Mapbox tiles/styles. */\n  attributionControl: PropTypes.bool, /** Show attribution control or not. */\n  preserveDrawingBuffer: PropTypes.bool, /** Useful when you want to export the canvas as a PNG. */\n  onLoad: PropTypes.func, /** The onLoad callback for the map */\n  onError: PropTypes.func, /** The onError callback for the map */\n  reuseMaps: PropTypes.bool,\n  reuseMap: PropTypes.bool,\n  transformRequest: PropTypes.func, /** The transformRequest callback for the map */\n\n  mapStyle: PropTypes.string, /** The Mapbox style. A string url to a MapboxGL style */\n  visible: PropTypes.bool, /** Whether the map is visible */\n\n  // Map view state\n  width: PropTypes.number, /** The width of the map. */\n  height: PropTypes.number, /** The height of the map. */\n\n  viewState: PropTypes.object, /** object containing lng/lat/zoom/bearing/pitch */\n\n  longitude: PropTypes.number, /** The longitude of the center of the map. */\n  latitude: PropTypes.number, /** The latitude of the center of the map. */\n  zoom: PropTypes.number, /** The tile zoom level of the map. */\n  bearing: PropTypes.number, /** Specify the bearing of the viewport */\n  pitch: PropTypes.number, /** Specify the pitch of the viewport */\n\n  // Note: Non-public API, see https://github.com/mapbox/mapbox-gl-js/issues/1137\n  altitude: PropTypes.number, /** Altitude of the viewport camera. Default 1.5 \"screen heights\" */\n  mapOptions: PropTypes.object /** Extra options to pass to Mapbox constructor. See #545. **/\n};\n\nconst defaultProps = {\n  mapboxApiAccessToken: getAccessToken(),\n  preserveDrawingBuffer: false,\n  attributionControl: true,\n  preventStyleDiffing: false,\n  onLoad: noop,\n  onError: noop,\n  reuseMaps: false,\n  reuseMap: false,\n  transformRequest: null,\n\n  mapStyle: 'mapbox://styles/mapbox/light-v8',\n  visible: true,\n\n  bearing: 0,\n  pitch: 0,\n  altitude: 1.5,\n\n  width: 0,\n  height: 0,\n\n  mapOptions: {}\n};\n\n// Try to get access token from URL, env, local storage or config\nexport function getAccessToken() {\n  let accessToken = null;\n\n  if (typeof window !== 'undefined' && window.location) {\n    const match = window.location.search.match(/access_token=([^&\\/]*)/);\n    accessToken = match && match[1];\n  }\n\n  if (!accessToken && typeof process !== 'undefined') {\n    // Note: This depends on bundler plugins (e.g. webpack) importing environment correctly\n    accessToken = accessToken || process.env.MapboxAccessToken || process.env.REACT_APP_MAPBOX_ACCESS_TOKEN; // eslint-disable-line\n  }\n\n  return accessToken || null;\n}\n\n// Helper function to merge defaultProps and check prop types\nfunction checkPropTypes(props, component = 'component') {\n  // TODO - check for production (unless done by prop types package?)\n  if (props.debug) {\n    PropTypes.checkPropTypes(propTypes, props, 'prop', component);\n  }\n}\n\n// A small wrapper class for mapbox-gl\n// - Provides a prop style interface (that can be trivially used by a React wrapper)\n// - Makes sure mapbox doesn't crash under Node\n// - Handles map reuse (to work around Mapbox resource leak issues)\n// - Provides support for specifying tokens during development\n\nexport default class Mapbox {\n  constructor(props) {\n    if (!props.mapboxgl) {\n      throw new Error('Mapbox not available');\n    }\n\n    if (!Mapbox.initialized && console.debug) { // eslint-disable-line\n      Mapbox.initialized = true;\n\n      // Version detection using babel plugin\n      /* global __VERSION__ */\n      const VERSION = typeof __VERSION__ !== 'undefined' ? __VERSION__ : 'untranspiled source';\n\n      console.debug(`react-map-gl: ${VERSION} using mapbox-gl v${props.mapboxgl.version}`); // eslint-disable-line\n\n      this._checkStyleSheet(props.mapboxgl.version);\n    }\n\n    this.props = {};\n    this._initialize(props);\n  }\n\n  finalize() {\n    this._destroy();\n    return this;\n  }\n\n  setProps(props) {\n    this._update(this.props, props);\n    return this;\n  }\n\n  // Mapbox's map.resize() reads size from DOM, so DOM element must already be resized\n  // In a system like React we must wait to read size until after render\n  // (e.g. until \"componentDidUpdate\")\n  resize() {\n    this._map.resize();\n    return this;\n  }\n\n  // External apps can access map this way\n  getMap() {\n    return this._map;\n  }\n\n  // PRIVATE API\n\n  _create(props) {\n    // Reuse a saved map, if available\n    if ((props.reuseMaps || props.reuseMap) && Mapbox.savedMap) {\n      this._map = this.map = Mapbox.savedMap;\n      // When reusing the saved map, we need to reparent the map(canvas) and other child nodes\n      // intoto the new container from the props.\n      // Step1: reparenting child nodes from old container to new container\n      const oldContainer = this._map.getContainer();\n      const newContainer = props.container;\n      newContainer.classList.add('mapboxgl-map');\n      while (oldContainer.childNodes.length > 0) {\n        newContainer.appendChild(oldContainer.childNodes[0]);\n      }\n      // Step2: replace the internal container with new container from the react component\n      this._map._container = newContainer;\n      Mapbox.savedMap = null;\n\n      // Update style\n      if (props.mapStyle) {\n        this._map.setStyle(props.mapStyle);\n      }\n\n      // TODO - need to call onload again, need to track with Promise?\n      props.onLoad();\n    } else {\n      const mapOptions = {\n        container: props.container || document.body,\n        center: [0, 0],\n        zoom: 8,\n        pitch: 0,\n        bearing: 0,\n        style: props.mapStyle,\n        interactive: false,\n        attributionControl: props.attributionControl,\n        preserveDrawingBuffer: props.preserveDrawingBuffer\n      };\n      // We don't want to pass a null or no-op transformRequest function.\n      if (props.transformRequest) {\n        mapOptions.transformRequest = props.transformRequest;\n      }\n      this._map = this.map = new props.mapboxgl.Map(\n        Object.assign({}, mapOptions, props.mapOptions));\n\n      // Attach optional onLoad function\n      this.map.once('load', props.onLoad);\n      this.map.on('error', props.onError);\n    }\n\n    return this;\n  }\n\n  _destroy() {\n    if (!this._map) {\n      return;\n    }\n\n    if (!Mapbox.savedMap) {\n      Mapbox.savedMap = this._map;\n    } else {\n      this._map.remove();\n    }\n    this._map = null;\n  }\n\n  _initialize(props) {\n    props = Object.assign({}, defaultProps, props);\n    checkPropTypes(props, 'Mapbox');\n\n    // Make empty string pick up default prop\n    this.accessToken = props.mapboxApiAccessToken || defaultProps.mapboxApiAccessToken;\n\n    // Creation only props\n    if (props.mapboxgl) {\n      if (!this.accessToken) {\n        props.mapboxgl.accessToken = 'no-token'; // Prevents mapbox from throwing\n      } else {\n        props.mapboxgl.accessToken = this.accessToken;\n      }\n    }\n\n    this._create(props);\n\n    // Disable outline style\n    const canvas = this.map.getCanvas();\n    if (canvas) {\n      canvas.style.outline = 'none';\n    }\n\n    this._updateMapViewport({}, props);\n    this._updateMapSize({}, props);\n\n    this.props = props;\n  }\n\n  _update(oldProps, newProps) {\n    if (!this._map) {\n      return;\n    }\n\n    newProps = Object.assign({}, this.props, newProps);\n    checkPropTypes(newProps, 'Mapbox');\n\n    this._updateMapViewport(oldProps, newProps);\n    this._updateMapSize(oldProps, newProps);\n\n    this.props = newProps;\n  }\n\n  // Note: needs to be called after render (e.g. in componentDidUpdate)\n  _updateMapSize(oldProps, newProps) {\n    const sizeChanged = oldProps.width !== newProps.width || oldProps.height !== newProps.height;\n    if (sizeChanged) {\n      this._map.resize();\n    }\n  }\n\n  _updateMapViewport(oldProps, newProps) {\n    const oldViewState = this._getViewState(oldProps);\n    const newViewState = this._getViewState(newProps);\n\n    const viewportChanged =\n      newViewState.latitude !== oldViewState.latitude ||\n      newViewState.longitude !== oldViewState.longitude ||\n      newViewState.zoom !== oldViewState.zoom ||\n      newViewState.pitch !== oldViewState.pitch ||\n      newViewState.bearing !== oldViewState.bearing ||\n      newViewState.altitude !== oldViewState.altitude;\n\n    if (viewportChanged) {\n      this._map.jumpTo(this._getMapboxViewStateProps(newProps));\n\n      // TODO - jumpTo doesn't handle altitude\n      if (newViewState.altitude !== oldViewState.altitude) {\n        this._map.transform.altitude = newViewState.altitude;\n      }\n    }\n  }\n\n  _getViewState(props) {\n    const {\n      longitude,\n      latitude,\n      zoom,\n      pitch = 0,\n      bearing = 0,\n      altitude = 1.5\n    } = props.viewState || props;\n    return {longitude, latitude, zoom, pitch, bearing, altitude};\n  }\n\n  _checkStyleSheet(mapboxVersion = '0.47.0') {\n    if (typeof document === 'undefined') {\n      return;\n    }\n\n    // check mapbox styles\n    try {\n      const testElement = document.createElement('div');\n      testElement.className = 'mapboxgl-map';\n      testElement.style.display = 'none';\n      document.body.append(testElement);\n      const isCssLoaded = window.getComputedStyle(testElement).position !== 'static';\n\n      if (!isCssLoaded) {\n        // attempt to insert mapbox stylesheet\n        const link = document.createElement('link');\n        link.setAttribute('rel', 'stylesheet');\n        link.setAttribute('type', 'text/css');\n        link.setAttribute('href',\n          `https://api.tiles.mapbox.com/mapbox-gl-js/v${mapboxVersion}/mapbox-gl.css`);\n        document.head.append(link);\n      }\n    } catch (error) {\n      // do nothing\n    }\n  }\n\n  _getMapboxViewStateProps(props) {\n    const viewState = this._getViewState(props);\n    return {\n      center: [viewState.longitude, viewState.latitude],\n      zoom: viewState.zoom,\n      bearing: viewState.bearing,\n      pitch: viewState.pitch,\n      width: props.width,\n      height: props.height\n    };\n  }\n}\n\nMapbox.propTypes = propTypes;\nMapbox.defaultProps = defaultProps;\n"],"file":"mapbox.js"}