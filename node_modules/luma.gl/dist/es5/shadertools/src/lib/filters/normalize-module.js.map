{"version":3,"sources":["../../../../../../src/shadertools/src/lib/filters/normalize-module.js"],"names":["defaultGetUniforms","module","props","uniforms","undefined","key","value","normalizeShaderModule","normalized","propTypes","getUniforms","bind"],"mappings":";;;;;;;AAAA;;AAEA,SAASA,kBAAT,CAA4BC,MAA5B,EAAoCC,KAApC,EAA2C;AACzC,MAAMC,QAAQ,GAAG,EAAjB;;AAEA,MAAID,KAAK,KAAKE,SAAd,EAAyB;AACvB,SAAK,IAAMC,GAAX,IAAkBJ,MAAM,CAACE,QAAzB,EAAmC;AACjCA,MAAAA,QAAQ,CAACE,GAAD,CAAR,GAAgBJ,MAAM,CAACE,QAAP,CAAgBE,GAAhB,EAAqBC,KAArC;AACD;;AACD,WAAOH,QAAP;AACD;;AAED,OAAK,IAAME,IAAX,IAAkBH,KAAlB,EAAyB;AACvB;AACAC,IAAAA,QAAQ,CAACE,IAAD,CAAR,GAAgBH,KAAK,CAACG,IAAD,CAArB;AACD;;AAED,SAAOF,QAAP;AACD,C,CAED;;;AACO,SAASI,qBAAT,CAA+BN,MAA/B,EAAuC;AAC5C,MAAI,CAACA,MAAM,CAACO,UAAZ,EAAwB;AACtBP,IAAAA,MAAM,CAACO,UAAP,GAAoB,IAApB,CADsB,CAGtB;;AACA,QAAIP,MAAM,CAACE,QAAX,EAAqB;AAAA,4BACC,+BAAeF,MAAM,CAACE,QAAtB,CADD;AAAA,UACZM,SADY,mBACZA,SADY;;AAEnBR,MAAAA,MAAM,CAACE,QAAP,GAAkBM,SAAlB;AACD,KAPqB,CAStB;;;AACA,QAAIR,MAAM,CAACE,QAAP,IAAmB,CAACF,MAAM,CAACS,WAA/B,EAA4C;AAC1CT,MAAAA,MAAM,CAACS,WAAP,GAAqBV,kBAAkB,CAACW,IAAnB,CAAwB,IAAxB,EAA8BV,MAA9B,CAArB;AACD;AACF;;AAED,SAAOA,MAAP;AACD","sourcesContent":["import {parsePropTypes} from './prop-types';\n\nfunction defaultGetUniforms(module, props) {\n  const uniforms = {};\n\n  if (props === undefined) {\n    for (const key in module.uniforms) {\n      uniforms[key] = module.uniforms[key].value;\n    }\n    return uniforms;\n  }\n\n  for (const key in props) {\n    // TODO validate, clamp etc\n    uniforms[key] = props[key];\n  }\n\n  return uniforms;\n}\n\n// Note: modifies and returns the same module\nexport function normalizeShaderModule(module) {\n  if (!module.normalized) {\n    module.normalized = true;\n\n    // Normalize uniforms\n    if (module.uniforms) {\n      const {propTypes} = parsePropTypes(module.uniforms);\n      module.uniforms = propTypes;\n    }\n\n    // Build a getUniforms from the uniforms array\n    if (module.uniforms && !module.getUniforms) {\n      module.getUniforms = defaultGetUniforms.bind(null, module);\n    }\n  }\n\n  return module;\n}\n"],"file":"normalize-module.js"}